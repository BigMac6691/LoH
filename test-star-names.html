<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Star Name Generator Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1a1a1a;
            color: #ffffff;
        }
        .test-section {
            background-color: #2a2a2a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid #444;
        }
        .test-result {
            background-color: #333;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: monospace;
            max-height: 300px;
            overflow-y: auto;
        }
        .success { border-left: 4px solid #4CAF50; }
        .error { border-left: 4px solid #f44336; }
        .info { border-left: 4px solid #2196F3; }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #45a049;
        }
        input {
            padding: 8px;
            margin: 5px;
            border-radius: 4px;
            border: 1px solid #444;
            background-color: #333;
            color: white;
            width: 100px;
        }
        .name-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin: 10px 0;
        }
        .name-item {
            background-color: #444;
            padding: 8px;
            border-radius: 4px;
            text-align: center;
            font-size: 14px;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 10px 0;
        }
        .stat-item {
            background-color: #444;
            padding: 10px;
            border-radius: 4px;
            text-align: center;
        }
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #4CAF50;
        }
        .stat-label {
            font-size: 12px;
            color: #ccc;
        }
    </style>
</head>
<body>
    <h1>Star Name Generator Test</h1>
    
    <div class="test-section">
        <h2>Basic Name Generation</h2>
        <button onclick="testBasicGeneration()">Generate 10 Names</button>
        <div id="basic-result" class="test-result"></div>
    </div>

    <div class="test-section">
        <h2>Unique Name Generation</h2>
        <input type="number" id="unique-count" placeholder="Count" value="20" min="1" max="100">
        <button onclick="testUniqueGeneration()">Generate Unique Names</button>
        <div id="unique-result" class="test-result"></div>
    </div>

    <div class="test-section">
        <h2>Name Statistics</h2>
        <button onclick="testNameStatistics()">Generate 50 Names & Show Stats</button>
        <div id="stats-result" class="test-result"></div>
    </div>

    <div class="test-section">
        <h2>Deterministic Generation</h2>
        <input type="number" id="seed-value" placeholder="Seed" value="12345">
        <button onclick="testDeterministicGeneration()">Test Deterministic Names</button>
        <div id="deterministic-result" class="test-result"></div>
    </div>

    <div class="test-section">
        <h2>Name Validation</h2>
        <button onclick="testNameValidation()">Test Name Validation</button>
        <div id="validation-result" class="test-result"></div>
    </div>

    <div class="test-section">
        <h2>Session Management</h2>
        <button onclick="testSessionManagement()">Test Session Management</button>
        <div id="session-result" class="test-result"></div>
    </div>

    <script type="module">
        import { generateStarName, getUniqueGeneratedName, clearUsedNames, getUsedNameCount, isNameUsed } from './shared/starNameGenerator.js';
        import SeededRandom from './shared/SeededRandom.js';

        window.testBasicGeneration = function() {
            const resultDiv = document.getElementById('basic-result');
            try {
                const seededRandom = new SeededRandom(42);
                const names = [];
                
                for (let i = 0; i < 10; i++) {
                    names.push(generateStarName(seededRandom));
                }
                
                resultDiv.innerHTML = `
                    <div class="success">
                        <strong>Generated 10 names:</strong>
                        <div class="name-grid">
                            ${names.map(name => `<div class="name-item">${name}</div>`).join('')}
                        </div>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error"><strong>Error:</strong> ${error.message}</div>`;
            }
        };

        window.testUniqueGeneration = function() {
            const resultDiv = document.getElementById('unique-result');
            try {
                const count = parseInt(document.getElementById('unique-count').value) || 20;
                const seededRandom = new SeededRandom(123);
                const names = [];
                
                // Clear any existing names first
                clearUsedNames();
                
                for (let i = 0; i < count; i++) {
                    names.push(getUniqueGeneratedName(seededRandom));
                }
                
                // Check for duplicates
                const uniqueSet = new Set(names);
                const hasDuplicates = uniqueSet.size !== names.length;
                
                resultDiv.innerHTML = `
                    <div class="${hasDuplicates ? 'error' : 'success'}">
                        <strong>Generated ${count} unique names:</strong>
                        <div class="stats">
                            <div class="stat-item">
                                <div class="stat-value">${names.length}</div>
                                <div class="stat-label">Total Names</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${uniqueSet.size}</div>
                                <div class="stat-label">Unique Names</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${hasDuplicates ? 'FAIL' : 'PASS'}</div>
                                <div class="stat-label">Uniqueness Test</div>
                            </div>
                        </div>
                        <div class="name-grid">
                            ${names.map(name => `<div class="name-item">${name}</div>`).join('')}
                        </div>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error"><strong>Error:</strong> ${error.message}</div>`;
            }
        };

        window.testNameStatistics = function() {
            const resultDiv = document.getElementById('stats-result');
            try {
                const seededRandom = new SeededRandom(456);
                const names = [];
                
                clearUsedNames();
                
                for (let i = 0; i < 50; i++) {
                    names.push(getUniqueGeneratedName(seededRandom));
                }
                
                // Calculate statistics
                const lengths = names.map(name => name.length);
                const avgLength = lengths.reduce((a, b) => a + b, 0) / lengths.length;
                const minLength = Math.min(...lengths);
                const maxLength = Math.max(...lengths);
                
                const syllables = names.map(name => {
                    const vowels = name.toLowerCase().match(/[aeiouy]/g) || [];
                    return vowels.length;
                });
                const avgSyllables = syllables.reduce((a, b) => a + b, 0) / syllables.length;
                
                const startsWithVowel = names.filter(name => /^[aeiouy]/i.test(name)).length;
                const startsWithConsonant = names.length - startsWithVowel;
                
                resultDiv.innerHTML = `
                    <div class="success">
                        <strong>Name Statistics (50 names):</strong>
                        <div class="stats">
                            <div class="stat-item">
                                <div class="stat-value">${avgLength.toFixed(1)}</div>
                                <div class="stat-label">Avg Length</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${minLength}-${maxLength}</div>
                                <div class="stat-label">Length Range</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${avgSyllables.toFixed(1)}</div>
                                <div class="stat-label">Avg Syllables</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${startsWithVowel}</div>
                                <div class="stat-label">Start with Vowel</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${startsWithConsonant}</div>
                                <div class="stat-label">Start with Consonant</div>
                            </div>
                        </div>
                        <div class="name-grid">
                            ${names.map(name => `<div class="name-item">${name}</div>`).join('')}
                        </div>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error"><strong>Error:</strong> ${error.message}</div>`;
            }
        };

        window.testDeterministicGeneration = function() {
            const resultDiv = document.getElementById('deterministic-result');
            try {
                const seed = parseInt(document.getElementById('seed-value').value) || 12345;
                const seededRandom1 = new SeededRandom(seed);
                const seededRandom2 = new SeededRandom(seed);
                
                clearUsedNames();
                
                const names1 = [];
                const names2 = [];
                
                for (let i = 0; i < 10; i++) {
                    names1.push(generateStarName(seededRandom1));
                    names2.push(generateStarName(seededRandom2));
                }
                
                const isDeterministic = names1.every((name, index) => name === names2[index]);
                
                resultDiv.innerHTML = `
                    <div class="${isDeterministic ? 'success' : 'error'}">
                        <strong>Deterministic Test (Seed: ${seed}):</strong>
                        <div class="stats">
                            <div class="stat-item">
                                <div class="stat-value">${isDeterministic ? 'PASS' : 'FAIL'}</div>
                                <div class="stat-label">Deterministic</div>
                            </div>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <strong>Run 1:</strong>
                                <div class="name-grid">
                                    ${names1.map(name => `<div class="name-item">${name}</div>`).join('')}
                                </div>
                            </div>
                            <div>
                                <strong>Run 2:</strong>
                                <div class="name-grid">
                                    ${names2.map(name => `<div class="name-item">${name}</div>`).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error"><strong>Error:</strong> ${error.message}</div>`;
            }
        };

        window.testNameValidation = function() {
            const resultDiv = document.getElementById('validation-result');
            try {
                const seededRandom = new SeededRandom(789);
                const testNames = [];
                
                // Generate some names and test validation
                for (let i = 0; i < 20; i++) {
                    testNames.push(generateStarName(seededRandom));
                }
                
                const validationResults = testNames.map(name => {
                    const isValid = name.length >= 3 && name.length <= 12 && 
                                  /^[a-zA-Z]/.test(name) && 
                                  !/[^a-zA-Z]/.test(name);
                    return { name, isValid };
                });
                
                const validNames = validationResults.filter(r => r.isValid);
                const invalidNames = validationResults.filter(r => !r.isValid);
                
                resultDiv.innerHTML = `
                    <div class="success">
                        <strong>Name Validation Test:</strong>
                        <div class="stats">
                            <div class="stat-item">
                                <div class="stat-value">${validNames.length}</div>
                                <div class="stat-label">Valid Names</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${invalidNames.length}</div>
                                <div class="stat-label">Invalid Names</div>
                            </div>
                        </div>
                        <div class="name-grid">
                            ${testNames.map(name => `<div class="name-item">${name}</div>`).join('')}
                        </div>
                        ${invalidNames.length > 0 ? `
                            <div class="error">
                                <strong>Invalid names found:</strong>
                                <div class="name-grid">
                                    ${invalidNames.map(r => `<div class="name-item">${r.name}</div>`).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error"><strong>Error:</strong> ${error.message}</div>`;
            }
        };

        window.testSessionManagement = function() {
            const resultDiv = document.getElementById('session-result');
            try {
                const seededRandom = new SeededRandom(999);
                
                // Test initial state
                clearUsedNames();
                const initialCount = getUsedNameCount();
                
                // Generate some names
                const names = [];
                for (let i = 0; i < 5; i++) {
                    names.push(getUniqueGeneratedName(seededRandom));
                }
                
                const afterGenerationCount = getUsedNameCount();
                
                // Test checking if names are used
                const isFirstUsed = isNameUsed(names[0]);
                const isRandomUsed = isNameUsed('RandomName123');
                
                // Clear and test again
                clearUsedNames();
                const afterClearCount = getUsedNameCount();
                const isAfterClearUsed = isNameUsed(names[0]);
                
                resultDiv.innerHTML = `
                    <div class="success">
                        <strong>Session Management Test:</strong>
                        <div class="stats">
                            <div class="stat-item">
                                <div class="stat-value">${initialCount}</div>
                                <div class="stat-label">Initial Count</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${afterGenerationCount}</div>
                                <div class="stat-label">After Generation</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${afterClearCount}</div>
                                <div class="stat-label">After Clear</div>
                            </div>
                        </div>
                        <div>
                            <strong>Generated names:</strong>
                            <div class="name-grid">
                                ${names.map(name => `<div class="name-item">${name}</div>`).join('')}
                            </div>
                        </div>
                        <div>
                            <strong>Validation tests:</strong><br>
                            Is "${names[0]}" used? ${isFirstUsed ? 'Yes' : 'No'}<br>
                            Is "RandomName123" used? ${isRandomUsed ? 'Yes' : 'No'}<br>
                            Is "${names[0]}" used after clear? ${isAfterClearUsed ? 'Yes' : 'No'}<br>
                        </div>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error"><strong>Error:</strong> ${error.message}</div>`;
            }
        };
    </script>
</body>
</html> 